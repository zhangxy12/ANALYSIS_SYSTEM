{"remainingRequest":"D:\\dasanshang\\NLP\\1\\Topic_and_user_profile_analysis_system\\code\\front_end\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\dasanshang\\NLP\\1\\Topic_and_user_profile_analysis_system\\code\\front_end\\src\\components\\all_detail\\time.vue?vue&type=style&index=0&id=0f6de8b0&prod&scoped=true&lang=css","dependencies":[{"path":"D:\\dasanshang\\NLP\\1\\Topic_and_user_profile_analysis_system\\code\\front_end\\src\\components\\all_detail\\time.vue","mtime":1741607300492},{"path":"D:\\dasanshang\\NLP\\1\\Topic_and_user_profile_analysis_system\\code\\front_end\\node_modules\\css-loader\\dist\\cjs.js","mtime":1733210773580},{"path":"D:\\dasanshang\\NLP\\1\\Topic_and_user_profile_analysis_system\\code\\front_end\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1733210773701},{"path":"D:\\dasanshang\\NLP\\1\\Topic_and_user_profile_analysis_system\\code\\front_end\\node_modules\\postcss-loader\\src\\index.js","mtime":1733210773504},{"path":"D:\\dasanshang\\NLP\\1\\Topic_and_user_profile_analysis_system\\code\\front_end\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1733210776394},{"path":"D:\\dasanshang\\NLP\\1\\Topic_and_user_profile_analysis_system\\code\\front_end\\node_modules\\vue-loader\\lib\\index.js","mtime":1733210773580}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQoucG9zdCB7DQogICAgY29sb3I6ICNmZmZmZmY7DQogICAgLyogYm9yZGVyLXJhZGl1czogOHB4OyAqLw0KICAgIGJveC1zaGFkb3c6IDAgNHB4IDEycHggcmdiYSgwLCAwLCAwLCAwLjEpOyAvKiDmt7vliqDpmLTlvbHmlYjmnpwgKi8NCiAgICBib3JkZXI6IDJweCBzb2xpZCAjNjY5ZWYzYTU7IC8qIOa3seiJsui+ueahhiAqLw0KICAgIGJvcmRlci1yYWRpdXM6IDEwcHg7DQogICAgYm94LXNpemluZzogYm9yZGVyLWJveDsNCg0KfQ0KDQoucG9zdF90b3Agew0KICAgIC8qIGRpc3BsYXk6IGZsZXg7ICovDQogICAgdGV4dC1hbGlnbjogY2VudGVyOw0KICAgIG1hcmdpbi1ib3R0b206IDEwcHg7DQogICAgZm9udC1zaXplOiAxOHB4Ow0KICAgIGZvbnQtd2VpZ2h0OiA4MDA7DQogICAgd2lkdGg6IDk5JTsNCn0NCg0KLnN0YXQtdGl0bGUgew0KICAgIHRleHQtYWxpZ246IGNlbnRlcjsNCn0NCg0KLnJhZGlvIHsNCiAgICBtYXJnaW4tbGVmdDogYXV0bzsNCn0NCg0KLnN0cmF0ZWd5LWFuYWx5c2lzIHsNCiAgICBvdmVyZmxvdy15OiBhdXRvOw0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAgZmxleC13cmFwOiB3cmFwOw0KICAgIG1hcmdpbi10b3A6IDFweDsNCiAgICBoZWlnaHQ6IDkwJTsNCiAgICB0ZXh0LWFsaWduOiBsZWZ0OyAvKiDorr7nva7mlbTkuKrnu4Tku7blhoXlrrnlt6blr7npvZAgKi8NCn0NCg0KLnN0YWdlIHsNCiAgICB3aWR0aDogOTAlOw0KICAgIHBhZGRpbmc6IDhweDsNCiAgICBtYXJnaW4tYm90dG9tOiAwcHg7DQogICAgdGV4dC1hbGlnbjogbGVmdDsgLyog6K6+572u5q+P5Liq6Zi25q615YaF5a655bem5a+56b2QICovDQp9DQoNCi5zdGFnZS10aXRsZSB7DQogICAgZm9udC13ZWlnaHQ6IGJvbGQ7DQogICAgbWFyZ2luLXJpZ2h0OiAxMHB4Ow0KfQ0KDQouZ3VpZGFuY2UtcGxhdGZvcm0gew0KICAgIHdpZHRoOiA3OCU7DQogICAgcGFkZGluZzogOHB4Ow0KICAgIG1hcmdpbi1ib3R0b206IDBweDsNCiAgICB0ZXh0LWFsaWduOiBsZWZ0OyAvKiDorr7nva7mr4/kuKrpmLbmrrXlhoXlrrnlt6blr7npvZAgKi8NCn0NCg0KLnBsYXRmb3JtLXRpdGxlIHsNCiAgICBmb250LXdlaWdodDogYm9sZDsNCiAgICBtYXJnaW4tYm90dG9tOiAxMHB4Ow0KfQ0K"},{"version":3,"sources":["time.vue"],"names":[],"mappings":";AA0NA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA","file":"time.vue","sourceRoot":"src/components/all_detail","sourcesContent":["<template>\r\n    <div class=\"post\" style=\"height: 100%;\">\r\n        <div class=\"post_top\">\r\n            <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"currentColor\" class=\"bi bi-clock-history\" viewBox=\"0 0 16 16\">\r\n  <path d=\"M8.515 1.019A7 7 0 0 0 8 1V0a8 8 0 0 1 .589.022zm2.004.45a7 7 0 0 0-.985-.299l.219-.976q.576.129 1.126.342zm1.37.71a7 7 0 0 0-.439-.27l.493-.87a8 8 0 0 1 .979.654l-.615.789a7 7 0 0 0-.418-.302zm1.834 1.79a7 7 0 0 0-.653-.796l.724-.69q.406.429.747.91zm.744 1.352a7 7 0 0 0-.214-.468l.893-.45a8 8 0 0 1 .45 1.088l-.95.313a7 7 0 0 0-.179-.483m.53 2.507a7 7 0 0 0-.1-1.025l.985-.17q.1.58.116 1.17zm-.131 1.538q.05-.254.081-.51l.993.123a8 8 0 0 1-.23 1.155l-.964-.267q.069-.247.12-.501m-.952 2.379q.276-.436.486-.908l.914.405q-.24.54-.555 1.038zm-.964 1.205q.183-.183.35-.378l.758.653a8 8 0 0 1-.401.432z\"/>\r\n  <path d=\"M8 1a7 7 0 1 0 4.95 11.95l.707.707A8.001 8.001 0 1 1 8 0z\"/>\r\n  <path d=\"M7.5 3a.5.5 0 0 1 .5.5v5.21l3.248 1.856a.5.5 0 0 1-.496.868l-3.5-2A.5.5 0 0 1 7 9V3.5a.5.5 0 0 1 .5-.5\"/>\r\n</svg>\r\n            <span class=\"stat-title\" style=\"align-items: center;\">   舆情引导策略分析</span>\r\n        </div>\r\n        <div class=\"strategy-analysis\" >\r\n            <div class=\"stage\">\r\n                <span class=\"stage-title\">开始阶段:</span>\r\n                <span>{{ analysis.start }}</span>\r\n            </div>\r\n            <div class=\"stage\">\r\n                <span class=\"stage-title\">扩散阶段:</span>\r\n                <span>{{ analysis.spread }}</span>\r\n            </div>\r\n            <div class=\"stage\">\r\n                <span class=\"stage-title\">高潮阶段:</span>\r\n                <span>{{ analysis.climax }}</span>\r\n            </div>\r\n            <div class=\"stage\">\r\n                <span class=\"stage-title\">退散阶段:</span>\r\n                <span>{{ analysis.fade }}</span>\r\n            </div>\r\n            <div class=\"guidance-platform\">\r\n            <span class=\"platform-title\">舆情主要引导平台:</span>\r\n            <span>{{ dominantPlatform }}</span>\r\n        </div>\r\n        </div>\r\n        \r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport axios from 'axios';\r\n\r\nexport default {\r\n    name: \"time\",\r\n    data() {\r\n        return {\r\n            radio: 1,\r\n            key: '',\r\n            timeData: {},\r\n            analysis: {\r\n                start: '',\r\n                spread: '',\r\n                climax: '',\r\n                fade: ''\r\n            },\r\n            dominantPlatform: ''\r\n        };\r\n    },\r\n    mounted() {\r\n        this.key = this.$route.query.key;\r\n        this.fetchData();\r\n    },\r\n    methods: {\r\n        async fetchData() {\r\n            try {\r\n                const response = await axios.get(`/topicPost?key=${encodeURIComponent(this.key)}`);\r\n                if (response.data.code === 0) {\r\n                    this.timeData = this.filterSixMonthsData(response.data.data);\r\n                    this.analyzeStages();\r\n                    this.findDominantPlatform();\r\n                }\r\n            } catch (error) {\r\n                console.error('获取数据出错:', error);\r\n            }\r\n        },\r\n        filterSixMonthsData(data) {\r\n            const sixMonthsAgo = new Date();\r\n            sixMonthsAgo.setMonth(sixMonthsAgo.getMonth() - 12);\r\n\r\n            const filteredData = {\r\n                renmin_date_count: {},\r\n                tieba_date_count: {},\r\n                wechat_date_count: {},\r\n                weibo_date_count: {}\r\n            };\r\n\r\n            const platforms = ['renmin_date_count', 'tieba_date_count', 'wechat_date_count', 'weibo_date_count'];\r\n            platforms.forEach(platform => {\r\n                for (const [date, count] of Object.entries(data[platform])) {\r\n                    const currentDate = new Date(date);\r\n                    if (currentDate >= sixMonthsAgo) {\r\n                        filteredData[platform][date] = count;\r\n                    }\r\n                }\r\n            });\r\n\r\n            return filteredData;\r\n        },\r\n        analyzeStages() {\r\n            const allData = {\r\n               ...this.timeData.renmin_date_count,\r\n               ...this.timeData.tieba_date_count,\r\n               ...this.timeData.wechat_date_count,\r\n               ...this.timeData.weibo_date_count\r\n            };\r\n            const sortedDates = Object.keys(allData).sort();\r\n\r\n            if (sortedDates.length > 0) {\r\n                this.analysis.start = sortedDates[0];\r\n            }\r\n\r\n            let prevCount = 0;\r\n            let stage = 'start';\r\n            let lastDate = null;\r\n            let climaxDate = null;\r\n            let spreadPeak = 0;\r\n\r\n            for (const date of sortedDates) {\r\n                const count = allData[date];\r\n                if (count > prevCount) {\r\n                    if (stage === 'start') {\r\n                        stage ='spread';\r\n                    }\r\n                }\r\n                if (count === Math.max(...Object.values(allData))) {\r\n                    stage = 'climax';\r\n                    climaxDate = date;\r\n                }\r\n                if (climaxDate) {\r\n                    break;\r\n                }\r\n                if (count > spreadPeak) {\r\n                    spreadPeak = count;\r\n                    this.analysis.spread = date;\r\n                }\r\n                prevCount = count;\r\n                lastDate = date;\r\n            }\r\n\r\n            if (climaxDate) {\r\n                this.analysis.climax = climaxDate;\r\n            }\r\n\r\n            // 继续遍历找退散阶段\r\n            let isFade = false;\r\n            for (const date of sortedDates) {\r\n                if (date === climaxDate) {\r\n                    isFade = true;\r\n                    continue;\r\n                }\r\n                if (isFade && allData[date] < allData[climaxDate]) {\r\n                    this.analysis.fade = date;\r\n                    break;\r\n                }\r\n            }\r\n\r\n            // 处理最后日期仍处于高潮阶段的情况\r\n            if (lastDate === this.analysis.climax) {\r\n                this.analysis.fade = '未退散';\r\n            }\r\n\r\n            // 确保日期依次增加\r\n            if (this.analysis.spread < this.analysis.start) {\r\n                this.analysis.spread = this.analysis.start;\r\n            }\r\n            if (this.analysis.climax < this.analysis.spread) {\r\n                this.analysis.climax = this.analysis.spread;\r\n            }\r\n            if (this.analysis.fade!== '未退散' && this.analysis.fade < this.analysis.climax) {\r\n                this.analysis.fade = '未退散';\r\n            }\r\n        },\r\n        findDominantPlatform() {\r\n            const stageWeights = {\r\n                start: 0.1,\r\n                spread: 0.3,\r\n                climax: 0.6,\r\n                fade: 0.0\r\n            };\r\n\r\n            const platformScores = {\r\n                '人民网': 0,\r\n                '贴吧': 0,\r\n                '微信': 0,\r\n                '微博': 0\r\n            };\r\n\r\n            const stageDates = {\r\n                start: this.analysis.start,\r\n                spread: this.analysis.spread,\r\n                climax: this.analysis.climax,\r\n                fade: this.analysis.fade\r\n            };\r\n\r\n            for (const [stage, date] of Object.entries(stageDates)) {\r\n                if (date && date!== '未退散') {\r\n                    const renminCount = this.timeData.renmin_date_count[date] || 0;\r\n                    const tiebaCount = this.timeData.tieba_date_count[date] || 0;\r\n                    const wechatCount = this.timeData.wechat_date_count[date] || 0;\r\n                    const weiboCount = this.timeData.weibo_date_count[date] || 0;\r\n\r\n                    platformScores['人民网'] += renminCount * stageWeights[stage];\r\n                    platformScores['贴吧'] += tiebaCount * stageWeights[stage];\r\n                    platformScores['微信'] += wechatCount * stageWeights[stage];\r\n                    platformScores['微博'] += weiboCount * stageWeights[stage];\r\n                }\r\n            }\r\n\r\n            let maxScore = 0;\r\n            for (const [platform, score] of Object.entries(platformScores)) {\r\n                if (score > maxScore) {\r\n                    maxScore = score;\r\n                    this.dominantPlatform = platform;\r\n                }\r\n            }\r\n        }\r\n    }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.post {\r\n    color: #ffffff;\r\n    /* border-radius: 8px; */\r\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1); /* 添加阴影效果 */\r\n    border: 2px solid #669ef3a5; /* 深色边框 */\r\n    border-radius: 10px;\r\n    box-sizing: border-box;\r\n\r\n}\r\n\r\n.post_top {\r\n    /* display: flex; */\r\n    text-align: center;\r\n    margin-bottom: 10px;\r\n    font-size: 18px;\r\n    font-weight: 800;\r\n    width: 99%;\r\n}\r\n\r\n.stat-title {\r\n    text-align: center;\r\n}\r\n\r\n.radio {\r\n    margin-left: auto;\r\n}\r\n\r\n.strategy-analysis {\r\n    overflow-y: auto;\r\n    display: flex;\r\n    flex-wrap: wrap;\r\n    margin-top: 1px;\r\n    height: 90%;\r\n    text-align: left; /* 设置整个组件内容左对齐 */\r\n}\r\n\r\n.stage {\r\n    width: 90%;\r\n    padding: 8px;\r\n    margin-bottom: 0px;\r\n    text-align: left; /* 设置每个阶段内容左对齐 */\r\n}\r\n\r\n.stage-title {\r\n    font-weight: bold;\r\n    margin-right: 10px;\r\n}\r\n\r\n.guidance-platform {\r\n    width: 78%;\r\n    padding: 8px;\r\n    margin-bottom: 0px;\r\n    text-align: left; /* 设置每个阶段内容左对齐 */\r\n}\r\n\r\n.platform-title {\r\n    font-weight: bold;\r\n    margin-bottom: 10px;\r\n}\r\n</style>"]}]}